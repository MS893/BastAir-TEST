<% content_for :title, "Créer un nouvel adhérent" %>

<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="mb-0">Créer un nouvel adhérent</h1>
        <%= link_to 'Retour au profil', user_path(current_user), class: 'btn btn-secondary' %>
      </div>

      <%# Affiche les erreurs de validation s'il y en a %>
      <% if @user.errors.any? %>
        <div class="alert alert-danger">
          <h5><%= pluralize(@user.errors.count, "erreur") %> a empêché cet adhérent d'être sauvegardé :</h5>
          <ul>
            <% @user.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <%= form_with(model: [:admin, @user], local: true) do |form| %>
        <div class="row">
          <div class="col-md-6 mb-3"><%= form.text_field :prenom, class: "form-control", placeholder: "Prénom" %></div>
          <div class="col-md-6 mb-3"><%= form.text_field :nom, class: "form-control", placeholder: "Nom" %></div>
        </div>
        <div class="mb-3"><%= form.email_field :email, class: "form-control", placeholder: "Adresse email" %></div>
        <div class="row">
          <div class="col-md-6 mb-3"><%= form.password_field :password, class: "form-control", placeholder: "Mot de passe" %></div>
          <div class="col-md-6 mb-3"><%= form.password_field :password_confirmation, class: "form-control", placeholder: "Confirmation du mot de passe" %></div>
        </div>

        <hr class="my-4">
        <h5 class="mb-3">Informations personnelles</h5>
        <div class="row">
          <div class="col-md-6 mb-3"><%= form.label :date_naissance %> <%= form.date_field :date_naissance, class: "form-control" %></div>
          <div class="col-md-6 mb-3"><%= form.text_field :lieu_naissance, class: "form-control", placeholder: "Lieu de naissance" %></div>
        </div>
        <div class="mb-3"><%= form.text_field :profession, class: "form-control", placeholder: "Profession" %></div>
        <div class="mb-3"><%= form.text_area :adresse, class: "form-control", placeholder: "Adresse complète" %></div>
        <div class="mb-3"><%= form.text_field :telephone, class: "form-control", placeholder: "Téléphone" %></div>
        <div class="mb-3"><%= form.text_field :contact_urgence, class: "form-control", placeholder: "Contact d'urgence (Nom + Tél)" %></div>

        <hr class="my-4">
        <h5 class="mb-3">Informations de licence</h5>
        <div class="row">
          <div class="col-md-6 mb-3"><%= form.text_field :num_ffa, class: "form-control", placeholder: "Numéro FFA" %></div>
          <div class="col-md-6 mb-3"><%= form.text_field :licence_type, class: "form-control", placeholder: "Type de licence (PPL, LAPL...)" %></div>
        </div>
        <div class="row">
          <div class="col-md-6 mb-3"><%= form.text_field :num_licence, class: "form-control", placeholder: "Numéro de licence" %></div>
          <div class="col-md-6 mb-3"><%= form.label :date_licence %> <%= form.date_field :date_licence, class: "form-control" %></div>
        </div>

        <hr class="my-4">
        <h5 class="mb-3">Validités et qualifications</h5>
        <div class="row">
          <div class="col-md-4 mb-3"><%= form.label :medical, "Visite médicale" %> <%= form.date_field :medical, class: "form-control" %></div>
          <div class="col-md-4 mb-3"><%= form.label :cotisation_club, "Cotisation Club" %> <%= form.date_field :cotisation_club, class: "form-control" %></div>
          <div class="col-md-4 mb-3"><%= form.label :cotisation_ffa, "Cotisation FFA" %> <%= form.date_field :cotisation_ffa, class: "form-control" %></div>
        </div>

        <hr class="my-4">
        <h5 class="mb-3">Statut et droits</h5>
        <div class="row">
          <div class="col-md-6 mb-3"><%= form.label :fonction %> <%= form.select :fonction, ['eleve', 'brevete', 'president', 'instructeur', 'mecanicien'], { prompt: 'Sélectionner une fonction' }, class: "form-select" %></div>
          <div class="col-md-6 mb-3"><%= form.label :solde %> <%= form.number_field :solde, class: "form-control", step: '0.01', placeholder: "0.00" %></div>
        </div>
        <div class="form-check form-switch mb-3"><%= form.check_box :autorise, class: "form-check-input" %> <%= form.label :autorise, "Autorisé à voler", class: "form-check-label" %></div>
        <div class="form-check form-switch mb-3"><%= form.check_box :admin, class: "form-check-input" %> <%= form.label :admin, "Administrateur", class: "form-check-label" %></div>

        <div class="text-center"><%= form.submit "Créer l'adhérent", class: "btn btn-primary btn-lg" %></div>
      <% end %>
    </div>
  </div>
</div>